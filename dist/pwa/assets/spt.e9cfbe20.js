import{d as l,P as d,N as n}from"./index.4e7ffe61.js";import{u as i}from"./auth.f8643573.js";import{api as e}from"./axios.0a2aaee7.js";const s=`${new Date().getFullYear()}/0${new Date().getMonth()+1}/${new Date().getDate()}`,r=new Date().getHours()+":"+(new Date().getMinutes()<10?"0":"")+new Date().getMinutes(),h=l("useSptStore",{state:()=>({onDialogAdd:!1,headerTittle:"Formulir Penambahan Surat Perintah Tugas",isLoading:!1,spt:{spt_id:null,tgl_awal:s,tgl_akhir:s,routing_id:null,routing_step_id:1,dasar:[],perihal:"",kecamatan:null,kelurahan:null,tempat:null,jam:r,isAllkota:!1,user_id:i().active.id,petugas:[{spt_pegawai_id:null,pegawai_id:null,jabatan_spt:"Koordinator"}],lat:.91599,lng:104.4634},onDetail:{isLoading:!1,data:{petugas:[],dasar:[],history:[{content:null}],step:{nama:null}}},data:{isLoading:!0,data:[]},pegawai:{isLoading:!0,data:[]}}),getters:{doubleCount(a){return a.counter*2}},actions:{BackToSptData(){d.remove("useSptStore"),this.onDialogAdd=!1,this.spt={spt_id:null,tgl_awal:s,tgl_akhir:s,routing_id:null,routing_step_id:1,dasar:[],perihal:"",kecamatan:null,kelurahan:null,tempat:null,jam:r,isAllkota:!1,user_id:i().active.id,petugas:[{spt_pegawai_id:null,pegawai_id:null,jabatan_spt:"Koordinator"}]}},async getData(){this.data.isLoading=!0,await e.post("/spt",{type:"spt-data"}).then(a=>{this.data.data=a.data.data}).catch(a=>{n.create({message:a.response.data.messages,color:"negative",icon:"error"})}).finally(a=>{this.data.isLoading=!1})},async dataById(a){this.onDetail.isLoading=!0,await e.post("/spt",{type:"spt-byId",id:a}).then(t=>{this.onDetail.data=t.data.data}).catch(t=>{n.create({message:t.response.data.messages,color:"negative",icon:"error"})}).finally(t=>{this.onDetail.isLoading=!1})},async dataInsert(){this.isLoading=!0,await e.post("/spt",{type:"spt-insert",data:this.spt}).then(a=>{this.BackToSptData(),this.router.push({name:"spt-detail",query:{id:a.data.data.spt_id}})}).catch(a=>{n.create({message:a.response.data.messages,color:"negative",icon:"error"})}).finally(a=>{this.isLoading=!1})},async pegawaiAvaibaleGet(){this.pegawai.isLoading=!0,await e.post("/spt",{type:"spt-pegawaiAvaiable"}).then(a=>{this.pegawai.data=a.data.data}).catch(a=>{console.log(a)}).finally(a=>{this.pegawai.isLoading=!1})}}}),c=l("useLaporanStore",{state:()=>({data:{isLoading:!0,data:[]},laporan:{isLoading:!1,spt:{sptupload:{nomor:null},dasar:[]},spt_laporan_id:null,spt_id:null,spt_pegawai_id:i().active.id,solusi:null,saran:"",tempat:null,unsur_sub_id:null,unsur_id:null,temuan:"",jam_selesai:null,attacemnt:[{spt_file_id:null,nomor:null,berkas:null,url:null,spt_id:null,kategori:"LAPORAN",user_id:i().active.id}]}}),actions:{async getData(){this.data.isLoading=!0,await e.post("/spt",{type:"laporan-by-petugas-data",userId:i().active.id}).then(a=>{this.data.data=a.data.data}).catch(a=>{n.create({message:a.response.data.messages,color:"negative",icon:"error"})}).finally(a=>{this.data.isLoading=!1})},async insertDataWithUpload(){await this.insertData(),await this.unggahLaporanFile(),await this.router.push({name:"laporan"})},async insertData(){this.laporan.isLoading=!0,await e.post("/spt",{type:"laporan-by-petugas",data:this.laporan}).then(a=>{}).catch(a=>{n.create({message:a.response.data.messages,color:"negative",icon:"error"})}).finally(a=>{this.laporan.isLoading=!1})},async unggahLaporanFile(){this.laporan.isLoading=!0;for(var a=0;a<this.laporan.attacemnt.length;a++){const t=new FormData;t.append("type","spt-unggah-laporan"),t.append("documentFile",this.laporan.attacemnt[a].berkas),t.append("data",JSON.stringify(this.laporan.attacemnt[a])),await e.post("/spt/unggah",t).then(o=>{n.create({message:"Berhasil Mengunggah Surat Perintah Tugas",color:"blue-8",icon:"info"})})}this.laporan.isLoading=!1},addAttacment(){this.laporan.attacemnt.push({spt_file_id:null,nomor:null,berkas:null,url:null,spt_id:null,kategori:"LAPORAN",user_id:i().active.id})}}}),_=l("useLaporanKejadianStore",{state:()=>({data:{isLoading:!0,data:[]},laporan:{isLoading:!1,laporan_kejadian_id:null,kejadian:{laporan_kejadian_id:null,nomor:null,pelapor:i().active.pegawai_id,kejadian_tgl:s,kejadian_jam:r,kejadian_tempat:null,deskripsi:"",operandi:"",pasal_pelanggaran:[],tindakan:{laporan_kejadian_tindakan_id:null,laporan_kejadian_id:null,tindakan:null,masa_tenggang_awal:s,masa_tenggang_akhir:s,user_id:i().active.pegawai_id},spt_id:0,spt_laporan_id:0,laporan_informasi_id:0,routing_id:2,routing_step_id:7,person:[{laporan_kejadian_person_id:null,nik:null,nama:null,alamat:null,laporan_kejadian_id:null,kategori:"PELAKU",hp:null,berkas:null,url:null}],attacemnt:[{laporan_kejadian_file_id:null,laporan_kejadian_id:null,berkas:null,url:null,nama:null,kategori:"BARANG BUKTI",user_id:i().active.pegawai_id}]}},onDetail:{isLoading:!1,data:{laporan_kejadian_id:null,pelapor:{nama:null},person:[],attacemnt:[],step:{nama:null}}}}),actions:{async getData(){this.data.isLoading=!0,await e.post("/laporan",{type:"laporan-kejadian-data",userId:i().active.id}).then(a=>{this.data.data=a.data.data}).catch(a=>{n.create({message:a.response.data.messages,color:"negative",icon:"error"})}).finally(a=>{this.data.isLoading=!1})},async getDataById(a){this.onDetail.isLoading=!0,await e.post("/laporan",{type:"laporan-kejadian-byId",id:a}).then(t=>{this.onDetail.data=t.data.data}).catch(t=>{n.create({message:t.response.data.messages,color:"negative",icon:"error"})}).finally(t=>{this.onDetail.isLoading=!1})},async insertDataWithUpload(){await this.insertData(),await this.UnggahDataPerson(),await this.UnggahDataFiles(),await this.router.push({name:"laporan"})},async insertData(){this.laporan.isLoading=!0,await e.post("/laporan",{type:"laporan-kejadian",data:this.laporan.kejadian}).then(a=>{this.laporan.laporan_kejadian_id=a.data.data.laporan_kejadian_id}).catch(a=>{n.create({message:a.response.data.messages,color:"negative",icon:"error"})}).finally(a=>{this.laporan.isLoading=!1})},async UnggahDataPerson(){this.laporan.isLoading=!0;for(var a=0;a<this.laporan.kejadian.person.length;a++){const t=new FormData;t.append("type","laporan-unggah-person"),t.append("documentFile",this.laporan.kejadian.person[a].berkas),t.append("data",JSON.stringify(this.laporan.kejadian.person[a])),t.append("lkId",JSON.stringify(this.laporan.laporan_kejadian_id)),await e.post("/laporan/unggah",t).then(o=>{n.create({message:"Berhasil Mengunggah Pelaku Dan Saksi-Saksi",color:"blue-8",icon:"info"})})}this.laporan.isLoading=!1},async UnggahDataFiles(){this.laporan.isLoading=!0;for(var a=0;a<this.laporan.kejadian.attacemnt.length;a++){const t=new FormData;t.append("type","laporan-unggah-files"),t.append("documentFile",this.laporan.kejadian.attacemnt[a].berkas),t.append("data",JSON.stringify(this.laporan.kejadian.attacemnt[a])),t.append("lkId",JSON.stringify(this.laporan.laporan_kejadian_id)),await e.post("/laporan/unggah",t).then(o=>{n.create({message:"Berhasil Mengunggah Pelaku Dan Saksi-Saksi",color:"blue-8",icon:"info"})})}this.laporan.isLoading=!1},addPersonKejadian(){this.laporan.kejadian.person.push({laporan_kejadian_person_id:null,nik:null,nama:null,alamat:null,laporan_kejadian_id:null,kategori:"SAKSI",hp:null,berkas:null,url:null})},addFilesKejadian(){this.laporan.kejadian.attacemnt.push({laporan_kejadian_file_id:null,laporan_kejadian_id:null,berkas:null,url:null,nama:null,kategori:"BARANG BUKTI",user_id:i().active.pegawai_id})}}});l("useDashboardStore",{state:()=>({data:{isLoading:!0,data:[]}}),actions:{async getData(){this.data.isLoading=!0,await e.post("/dashboard",{type:"spt-by-pegawai",userId:i().active.id}).then(a=>{this.data.data=a.data.data}).catch(a=>{n.create({message:a.response.data.messages,color:"negative",icon:"error"})}).finally(a=>{this.data.isLoading=!1})}}});export{c as a,_ as b,h as u};
