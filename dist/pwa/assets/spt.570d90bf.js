import{Q as v}from"./QBadge.5a60af85.js";import{_ as w,a as T,aJ as D,r as U,l as B,B as C,N as P,f as q,o as d,ad as p,Z as t,g as e,w as l,am as u,ae as m,ai as V,a0 as _,e as I,$ as h,aV as L,aW as N}from"./index.4e7ffe61.js";import{Q as x}from"./QSeparator.cba34036.js";import{Q as f}from"./QCardSection.d5991535.js";import{Q as S}from"./QCard.3bac19a9.js";import{a as A,Q as k}from"./QItem.83867145.js";import{Q}from"./QItemLabel.3f711634.js";import{Q as R}from"./QInput.45689bc6.js";import{Q as E}from"./QBanner.0f8aee67.js";import{Q as F}from"./QForm.2a6e580a.js";import{Q as $}from"./QInnerLoading.1db0864f.js";import{Q as z}from"./QDialog.3ba84a94.js";import{u as O}from"./spt.e9cfbe20.js";import{u as M}from"./auth.f8643573.js";import{api as G}from"./axios.0a2aaee7.js";import"./use-dark.310a2ad4.js";import"./uid.7f2d5a47.js";import"./focus-manager.4350be2f.js";import"./use-transition.405b2041.js";import"./use-prevent-scroll.7bdeec7e.js";import"./scroll.fd17398b.js";import"./use-timeout.a9330d7f.js";import"./ref.4ae668e5.js";const c=O(),j=M(),H=T({name:"spt-detail-spt",setup(){const a=D(),n=U(null),y=B(()=>c.onDetail.isLoading),b=B(()=>c.onDetail.data),s=C({dialog:!1,spt_file_id:null,nomor:null,url:null,berkas:null,isLoading:!1,errorBerkas:!1,spt_id:a.query.id,kategori:"SPT",user_id:j.active.id});return{isLoading:y,spt:b,myForm:n,uploadSpt:s,onUploadSpt(){s.dialog=!0,s.nomor=null,s.url=null,s.berkas=null,s.errorBerkas=null},OnChangeUnggahBerkas(g){let i=new FileReader;s.berkas=g.target.files[0],s.isLoading=!0,i.readAsDataURL(g.target.files[0]),i.onload=async o=>{s.errorBerkas=!1,s.url=o.target.result,s.isLoading=!1}},onValidateDB(){n.value.validate().then(g=>{if(g){if(s.url==null){s.errorBerkas=!0;return}s.isLoading=!0;const i=new FormData;i.append("type","spt-unggah-spt"),i.append("documentFile",s.berkas),i.append("data",JSON.stringify(s)),G.post("/spt/unggah",i).then(o=>{s.isLoading=!1,s.dialog=!1,c.onDetail.data.sptupload=o.data.data,c.onDetail.data.history.push(o.data.history),c.onDetail.data.step=o.data.step,c.onDetail.data.routing_step_id=o.data.step.routing_step_id,P.create({message:"Berhasil Mengunggah Surat Perintah Tugas",color:"blue-8",icon:"info"})})}})}}}}),r=a=>(L("data-v-6b182d0a"),a=a(),N(),a),J={style:{"overflow-x":"auto"}},K={key:0},W=r(()=>t("tr",null,[t("td",null,"No. Surat"),t("td",null," : "),t("td",null," - ")],-1)),Z=r(()=>t("td",null,"Status",-1)),X=r(()=>t("td",null," : ",-1)),Y={key:1},tt=r(()=>t("td",null,"No. Surat",-1)),et=r(()=>t("td",null," : ",-1)),at=r(()=>t("td",null,"Status",-1)),st=r(()=>t("td",null," : ",-1)),lt={key:1,class:"bg-grey-3 radius10 q-mt-md q-pa-md shadow-2"},ot={class:"row justify-center q-col-gutter-md"},rt={class:"col-lg-4 col-md-4 col-sm-6 col-xs-6"},nt=r(()=>t("p",{class:"q-mb-none text-subtitle1 text-weight-bold"},"Upload Surat Perintah Tugas",-1)),it=r(()=>t("span",{class:"text-caption text-grey-8"},"(Surat Perintah Tugas yang telah di TTD Secara Elektornik)",-1)),dt={class:"col-lg-4 col-md-4 col-sm-6 col-xs-6"},ut=["href"],pt=r(()=>t("p",{class:"q-mb-none text-subtitle1 text-weight-bold"},"Unduh Surat Perintah Tugas",-1)),mt=r(()=>t("span",{class:"text-caption text-grey-8"},[u("(Surat Perintah Tugas Berformat .word yang "),t("span",{class:"text-weight-bold"},"Belum di TTD Secara Elektornik)")],-1)),ct=r(()=>t("img",{src:"/images/siaptindak.png",style:{width:"80px"}},null,-1)),gt={class:"row q-col-gutter-sm"},ft={class:"col-lg-8 col-md-8 col-sm-12 col-xs-12"},_t={class:"col-lg-4 col-md-4 col-sm-12 col-xs-12"},ht={for:"file"},St={key:0,class:"col-sm-12"},kt={key:0,class:"q-mt-md"},yt={class:"q-gutter-sm"};function bt(a,n,y,b,s,g){const i=q("q-pdfviewer");return d(),p("div",null,[t("div",J,[a.spt.sptupload==null?(d(),p("table",K,[W,t("tr",null,[Z,X,t("td",null,[e(v,{color:"red-5"},{default:l(()=>[u("Surat Perintah Tugas Belum di Unggah ")]),_:1})])])])):m("",!0),a.spt.sptupload!=null?(d(),p("table",Y,[t("tr",null,[tt,et,t("td",null,V(a.spt.sptupload.nomor),1)]),t("tr",null,[at,st,t("td",null,[e(_,{label:"pratinjau",icon:"visibility",class:"radius5 q-mr-md",size:"sm",color:"blue-8",href:a.spt.sptupload.url,target:"_blank",unelevated:""},null,8,["href"]),e(v,{color:"positive"},{default:l(()=>[u("Surat Perintah Tugas Telah Di unggah ")]),_:1})])])])):m("",!0)]),a.spt.sptupload!=null?(d(),I(x,{key:0,class:"q-mt-md"})):m("",!0),a.spt.sptupload==null?(d(),p("section",lt,[t("div",ot,[t("div",rt,[e(S,{class:"radius10 text-center cursor-pointer",onClick:a.onUploadSpt},{default:l(()=>[e(f,null,{default:l(()=>[e(h,{name:"create_new_folder",size:"6em",color:"blue-8"}),nt,it]),_:1})]),_:1},8,["onClick"])]),t("div",dt,[e(S,{class:"radius10 text-center"},{default:l(()=>[e(f,{class:"unduhDraft"},{default:l(()=>[t("a",{href:a.spt.urlDraft,target:"_blank"},[e(h,{name:"file_download",size:"6em",color:"primary"}),pt,mt],8,ut)]),_:1})]),_:1})])])])):m("",!0),e(z,{persistent:"",modelValue:a.uploadSpt.dialog,"onUpdate:modelValue":n[3]||(n[3]=o=>a.uploadSpt.dialog=o)},{default:l(()=>[e(S,{style:{width:"700px","max-width":"80vw"},class:"radius10"},{default:l(()=>[e(A,null,{default:l(()=>[e(k,{avatar:""},{default:l(()=>[ct]),_:1}),e(k),e(k,{side:"",class:"text-black"},{default:l(()=>[e(Q,null,{default:l(()=>[u("SURAT PERINTAH TUGAS")]),_:1}),e(Q,{caption:""},{default:l(()=>[u("Unggah SPT TTD Elektronik")]),_:1})]),_:1})]),_:1}),e(f,null,{default:l(()=>[e(F,{ref:"myForm"},{default:l(()=>[t("div",gt,[t("div",ft,[e(R,{dense:"",filled:"",label:"Nomor Surat Perintah Tugas",modelValue:a.uploadSpt.nomor,"onUpdate:modelValue":n[0]||(n[0]=o=>a.uploadSpt.nomor=o),rules:[o=>o!==null&&o!==""||"Please type something"]},null,8,["modelValue","rules"])]),t("div",_t,[t("input",{type:"file",name:"file",id:"file",class:"inputfile",onChange:n[1]||(n[1]=(...o)=>a.OnChangeUnggahBerkas&&a.OnChangeUnggahBerkas(...o))},null,32),t("label",ht,[e(h,{name:"upload",size:"sm",class:"q-mr-sm"}),u("Pilih Berkas .Pdf")])]),a.uploadSpt.errorBerkas?(d(),p("div",St,[e(E,{class:"bg-red-3 radius10"},{default:l(()=>[u(" BERKAS BELUM DI UNGGAH")]),_:1})])):m("",!0)])]),_:1},512),a.uploadSpt.url?(d(),p("section",kt,[e(i,{src:a.uploadSpt.url,type:"html5",style:{height:"400px"}},null,8,["src"])])):m("",!0)]),_:1}),e(f,{class:"bg-grey-3"},{default:l(()=>[t("div",yt,[e(_,{label:"Ok, Proses",color:"primary",unelevated:"",icon:"upload",class:"radius5",onClick:a.onValidateDB},null,8,["onClick"]),e(_,{label:"Batal",color:"grey-8",flat:"",class:"radius5",onClick:n[2]||(n[2]=o=>a.uploadSpt.dialog=!1)})])]),_:1}),e($,{showing:a.uploadSpt.isLoading,label:"Mohon Menunggu, memproses data...","label-class":"text-secondary","label-style":"font-size: 1.1em"},null,8,["showing"])]),_:1})]),_:1},8,["modelValue"])])}var Gt=w(H,[["render",bt],["__scopeId","data-v-6b182d0a"]]);export{Gt as default};
