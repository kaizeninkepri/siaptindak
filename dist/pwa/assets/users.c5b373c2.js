import{d as i,N as s}from"./index.4e7ffe61.js";import{api as r}from"./axios.0a2aaee7.js";import{u as o}from"./auth.f8643573.js";const n=o(),u=[{name:"idnex",required:!0,label:"No",align:"left",field:e=>e.index+1,format:e=>`${e}`,sortable:!0},{name:"nama",required:!0,label:"Nama Lengkap",align:"left",field:e=>e.name,format:e=>`${e}`,sortable:!0},{name:"email",required:!0,label:"Email",align:"left",field:e=>e.email,format:e=>`${e}`,sortable:!0},{name:"role",align:"left",label:"Role",field:e=>e.role.nama,sortable:!0},{name:"bagian",label:"Bagian",field:e=>e.devisi.nama,sortable:!0},{name:"jabatan",label:"Jabatan",field:e=>e.devisisub.nama},{name:"is_active",label:"Aktif",field:e=>e.is_active}],h=i("useUsersStore",{state:()=>({columns:u,form:{id:null,name:null,email:null,password:null,role_id:null,devisi_id:null,devisi_sub_id:null,identitas_no:null,identitas_type:null,is_active:!0},data:[],profile:{},search:null,currentUser:{id:null,name:null,email:null},loading:{form:!1,table:!1},dialog:{changePassword:!1},password:{new:null,confirm:null}}),getters:{rows(e){const t=e.data.map((a,l)=>(a.index=l,a));return this.search==null||this.search==""?t:t.filter(a=>a.name.toLowerCase().includes(this.search.toLowerCase())||a.email.toLowerCase().includes(this.search.toLowerCase()))}},actions:{set_user(){r.post("/users",{type:"store-user",data:this.form}).then(e=>{this.form={id:null,name:null,email:null,password:null,role_id:null,devisi_id:null,devisi_sub_id:null,identitas_no:null,identitas_type:null,is_active:!0},this.router.push({name:"users"}),s.create({message:e.data.message,color:"positive",position:"top-right",icon:"error"})}).catch(e=>{s.create({message:e.response.data.messages,color:"negative",icon:"error"})}).finally(e=>{})},set_delete(e,t){this.loading.table=!0,r.post("/users",{type:"delete-user",id:t}).then(a=>{this.data.splice(e,1),s.create({message:a.data.message,color:"positive",position:"top-right",icon:"error"})}).catch(a=>{s.create({message:a.response.data.messages,color:"negative",icon:"error"})}).finally(a=>{this.loading.table=!1})},set_ChangePassword(e,t){this.loading.form=!0,r.post("/users",{type:"change-password",id:this.profile.id,password:this.password.new}).then(a=>{this.loading.form=!1,this.dialog.changePassword=!1,s.create({message:"Password Berhasil di rubah",color:"positive",position:"top-right",icon:"error"})}).catch(a=>{s.create({message:a.response.data.messages,color:"negative",icon:"error"})}).finally(a=>{this.loading.form=!1})},get_users(){this.loading.table=!0,this.search=null,r.post("/users",{type:"get-users"}).then(e=>{this.data=e.data}).catch(e=>{s.create({message:e.response.data.messages,color:"negative",icon:"error"})}).finally(e=>{this.loading.table=!1,this.search=null})},get_user(){this.loading.table=!0,this.search=null,r.post("/users",{type:"get-userId",id:n.active.id}).then(e=>{this.profile=e.data}).catch(e=>{s.create({message:e.response.data.messages,color:"negative",icon:"error"})}).finally(e=>{this.loading.table=!1,this.search=null})},checkingUser(e,t){r.post("/ref",{type:"checking-users",data:{label:e,value:t}}).then(a=>{a.data.status==!0&&(s.create({message:"data "+e+" telah digunakan ",color:"negative",position:"center",icon:"error"}),this.form[e]=null)}).catch(a=>{s.create({message:a.response.data.messages,color:"negative",icon:"error"})}).finally(a=>{})}}});export{h as u};
